<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
  </head>
  <body>
    <audio controls preload="auto"></audio>
    <input type="text" id="selector">
    <button id="button">播放</button>
    <button id="stop">暂停</button>
    <script src="./lame.js"></script>
    <script type="module">
      import wavToMp3 from './wavToMp3.js'
      import TTSPlay from '../dist/ttsplayer/TTSPlayer-esm.js'
      const $audio = document.querySelector('audio')
      const ttsOption = {
        appid: "test1234",
        aue: "raw",
        auf: "4",
        auth_id: "1234567890",
        bgs: 0,
        engine_name: "tts_online",
        extend_params: '{"params":"token=appid123,ability=ab_tts,vol=0,spd=0,pit=0,effect=0,bgs=0"}',
        pit: 0,
        ram: 0,
        spd: 0,
        vid: "65620",
        vol: 0
      }
      const $input = document.querySelector('#selector')
      const $button = document.querySelector('#button')
      const ttsplayer = new TTSPlay()
      $button.addEventListener('click', function () {
        ttsplayer.playAudio({  url: 'http://172.31.3.142:8087/tts', text: $input.value, ttsOption, $audio }, wavToMp3)
      })
      document.querySelector('#stop').addEventListener('click', function () {
        ttsplayer.stop()
      })
    </script>
  </body>
</html>
